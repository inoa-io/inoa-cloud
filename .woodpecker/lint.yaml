when:
  - event: [manual, pull_request]
  - event: push
    branch: main

steps:
  backstage:
    image: ghcr.io/grayc-de/plugins/backstage-entity-validator
    depends_on: []
    when: [path: [catalog-info.yaml]]

  kustomize:
    image: ghcr.io/grayc-de/plugins/kubectl
    depends_on: []
    commands:
      - kubectl kustomize ./fluxcd/kiste/dev
      - kubectl kustomize ./fluxcd/kiste/prod
      - kubectl kustomize ./fluxcd/live/dev
      - kubectl kustomize ./fluxcd/live/prod
    when: [path: [fluxcd/**]]

  maven:
    image: ghcr.io/grayc-de/plugins/inoa
    depends_on: []
    commands: [mvn validate]
    when: [path: ["**/*.java", "**/pom.xml"]]
